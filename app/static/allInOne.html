<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>올인원</title>
    <!-- 부트스트랩 css -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
  </head>
  <body class="m-3">
    <div id="button-div">
      <button data-page-id="img-to-text">사진에서 텍스트 추출</button>
      <button data-page-id="word">텍스트에서 아이템 추출</button>
      <button data-page-id="calc">분배금 계산기</button>
    </div>
    <hr />
    <div id="page-div">
      <div id="img-to-text">
        <h1>사진에서 텍스트 추출</h1>
      </div>
      <div id="word" hidden>
        <h1>텍스트에서 아이템 추출</h1>
        <br />
        <p>주의 : 등장 횟수와 수량이 맞지 않을 수 있습니다.</p>
        <p>예시)</p>
        <p>꺼지지 않는 불꽃 아이템을 2개 얻었습니다. (기타)    =>    등장 1회, 획득 2개</p>
        <hr />
        <br />
  
        <div>
          <p>붙여넣어주세요</p>
          <div>
            <textarea style="width: 70%;resize: none;" rows="15" id="the-text" /></textarea>
          </div>
          <br />
          <button onclick="wordCalculate()">제출하기</button>
        </div>
  
        <div>
          <table class="table table-sm" style="width: 30%;;">
            <thead>
              <tr>
                <th scope="col">품목</th>
                <th scope="col">등장 횟수</th>
              </tr>
            </thead>
            <tbody id="table-body">
            </tbody>
          </table>
        </div>
      </div>
      <div id="calc" hidden><h1>분배금 계산기</h1></div>
    </div>
  </body>
  <script>
    // 페이지 선택
    function pageSelect() {
      let selected = "img-to-text";
      const buttonDiv = document.getElementById("button-div");
      buttonDiv.onclick = function (event) {
        const id = event.target.dataset.pageId;
        if (!id) return;
        document.getElementById(selected).hidden = true;
        document.getElementById(id).hidden = false;
        selected = id;
      };
    }
    pageSelect();
    //
    // 텍스트에서 아이템 추출
    function wordCalculate() {
        theText = document.getElementById('the-text').value.trim()
        const tableList = {};
        tableList['검은 환생의 불꽃'] = theText.split('검은 환생의 불꽃').length - 1  // 검은 환생의 불꽃
        tableList['영원한 환생의 불꽃'] = theText.split('영원한 환생의').length - 1  // 영원한 환생의
        tableList['강력한 환생의 불꽃'] = theText.split('강력한 환생의').length - 1  // 강력한 환생의
        
        tableList['태초의 정수'] = theText.split('태초의 정수').length - 1  // 태초의 정수
        tableList['영원히 꺼지지 않는 불꽃'] = theText.split('영원히 꺼지지').length - 1  // 영원히 꺼지지 (영꺼 + 검꺼)
        tableList['꺼지지 않는 불꽃'] = theText.split('꺼지지 않는 불꽃').length - 1  // 꺼지지 않는 불꽃
        
        tableList['아케인셰이드 방어구 상자'] = theText.split('아케인셰이드 방').length - 1  // 아케인셰이드 방
        tableList['아케인셰이드 무기 상자'] = theText.split('아케인셰이드 무').length - 1  // 아케인셰이드 무
        
        tableList['매지컬 무기 주문서 교환권'] = theText.split('매지컬 무기').length - 1  // 프리미엄 펫장비
        tableList['프리미엄 펫장비 스크롤 교환권'] = theText.split('프리미엄 펫장비').length - 1  // 프리미엄 펫장비
        tableList['프리미엄 악세서리 스크롤 교환권'] = theText.split('프리미엄 악세').length - 1  // 프리미엄 펫장비
        
        tableList['소형 고농축 경험 축적의 비약'] = theText.split('소형 고농축 경').length - 1  // 소형 고농축 경
        tableList['소형 경험 축적의 비약'] = theText.split('소형 경험 축적').length - 1  // 소형 경험 축적
        tableList['놀라운 긍정의 혼돈주문서'] = theText.split('놀라운 긍정의').length - 1  // 놀라운 긍정의
        tableList['대형 보스 명예의 훈장'] = theText.split('대형 보스 명예').length - 1  // 대형 보스 명예
        tableList['반짝이는 빨간별 물약'] = theText.split('반짝이는 빨간').length - 1  // 반짝이는 빨간
        tableList['반짝이는 파란별 물약'] = theText.split('반짝이는 파란').length - 1  // 반짝이는 파란
        tableList['추가경험치 50% 쿠폰'] = theText.split('추가 경험치 50').length - 1  // 추가 경험치 50
        
        const tableBody = document.getElementById('table-body')
        tableBody.replaceChildren()
        for (const key in tableList) {
          const tableR = tableBody.insertRow();
          const tableC1 = tableR.insertCell();
          const tableD1 = document.createTextNode(`${key}`)
          tableC1.appendChild(tableD1)
          const tableC2 = tableR.insertCell();
          const tableD2 = document.createTextNode(`${tableList[key]}`)
          tableC2.appendChild(tableD2)
        }
      }
    // 
  </script>
  <!-- 부트스트랩 자바스크립트 -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"
  ></script>
  <script></script>
</html>
